LIST P=PIC16F1938
#include<p16f1938.inc>
__CONFIG    _CONFIG1, _FOSC_INTOSC & _WDTE_OFF & _PWRTE_ON & _MCLRE_OFF & _CP_OFF & _CPD_OFF & _BOREN_OFF & _CLKOUTEN_OFF & _IESO_OFF & _FCMEN_OFF  
__CONFIG    _CONFIG2, _WRT_OFF & _VCAPEN_OFF & _PLLEN_OFF & _STVREN_OFF & _BORV_LO & _LVP_ON

MATRIX_ROW_0	EQU 0x20
MATRIX_ROW_1	EQU 0x21
MATRIX_ROW_2	EQU 0x22
MATRIX_ROW_3	EQU 0x23
MATRIX_ROW_4	EQU 0x24
MATRIX_ROW_5	EQU 0x25
MATRIX_ROW_6	EQU 0x26
MATRIX_ROW_7	EQU 0x27
DELAY_CNT0	EQU 0x28
DELAY_CNT1	EQU 0x29

;ORG	0x1000
;	DATA	0x00, 0x01
	
ORG	0x0000				
	;バンク1に切り替え
	BSF	BSR, BSR0
	;;OSCCONレジスタを操作して、周期を4MHzに変更する
	MOVLW	B'01101000'
	MOVWF	OSCCON
	;PORTBを出力にする
	MOVLW	B'00000000'
	MOVWF	TRISB
	;PORTCを出力にする
	MOVLW	B'00000000'
	MOVWF	TRISC
	;バンク0に切り替え
	BCF	BSR, BSR0
	;PORTBとPORTCの出力を0にする
	MOVLW	B'00000000'
	MOVWF	PORTB
	MOVLW	B'00000000'
	MOVWF	PORTC
LOOP					
	CALL	TEST
	GOTO 	LOOP			

TEST
;	MOVLW	B'11111111'
;	MOVWF	PORTC
;	MOVLW	B'01111111'
;	MOVWF	PORTB
;	CALL	LED_DELAY
	MOVLW	B'10000000'
	MOVWF	MATRIX_ROW_0
	MOVLW	B'01000000'
	MOVWF	MATRIX_ROW_1
	MOVLW	B'00100000'
	MOVWF	MATRIX_ROW_2
	MOVLW	B'00010000'
	MOVWF	MATRIX_ROW_3
	MOVLW	B'00001000'
	MOVWF	MATRIX_ROW_4
	MOVLW	B'00000100'
	MOVWF	MATRIX_ROW_5
	MOVLW	B'00000010'
	MOVWF	MATRIX_ROW_6
	MOVLW	B'00000010'
	MOVWF	MATRIX_ROW_7
	CALL	LIGHT_MATRIX
	RETURN

TEST_ANIMATION
	
	
LIGHT_MATRIX
	;0行目
	MOVF	MATRIX_ROW_0, W
	MOVWF	PORTC
	MOVLW	B'01111111'
	MOVWF	PORTB
	CALL	LED_DELAY
	;1行目
	MOVF	MATRIX_ROW_1, W
	MOVWF	PORTC
	MOVLW	B'10111111'
	MOVWF	PORTB
	CALL	LED_DELAY
	;2行目
	MOVF	MATRIX_ROW_2, W
	MOVWF	PORTC
	MOVLW	B'11011111'
	MOVWF	PORTB
	CALL	LED_DELAY
	;3行目
	MOVF	MATRIX_ROW_3, W
	MOVWF	PORTC
	MOVLW	B'11101111'
	MOVWF	PORTB
	CALL	LED_DELAY
	;4行目
	MOVF	MATRIX_ROW_4, W
	MOVWF	PORTC
	MOVLW	B'11110111'
	MOVWF	PORTB
	CALL	LED_DELAY
	;5行目
	MOVF	MATRIX_ROW_5, W
	MOVWF	PORTC
	MOVLW	B'11111011'
	MOVWF	PORTB
	CALL	LED_DELAY
	;6行目
	MOVF	MATRIX_ROW_6, W
	MOVWF	PORTC
	MOVLW	B'11111101'
	MOVWF	PORTB
	CALL	LED_DELAY
	;7行目
	MOVF	MATRIX_ROW_7, W
	MOVWF	PORTC
	MOVLW	B'01111110'
	MOVWF	PORTB
	CALL	LED_DELAY
	RETURN
	
LED_DELAY
	MOVLW	0x00
	MOVWF	DELAY_CNT0
LED_DELAY_JUMP0
	MOVLW	0x01
	MOVWF	DELAY_CNT1
LED_DELAY_JUMP1
	DECFSZ	DELAY_CNT0, F
	GOTO	LED_DELAY_JUMP1
	DECFSZ	DELAY_CNT1, F
	GOTO	LED_DELAY_JUMP0
	RETURN
END










